const m=typeof document<"u";class u{removeHandler=null;async remove(){await this.removeHandler?.(),this.removeHandler=null}async toggle(e){this.removeHandler?this.remove():this.add(e)}async reset(e){await this.remove(),await this.add(e)}}class s extends u{static timeoutIdMap=new WeakMap;copyButtonClick(e){const t=e.target;if(t.matches('div[class*="language-"] > button.copy')){const n=t.parentElement,o=t.nextElementSibling?.nextElementSibling;if(!n||!o)return;const r=/language-(shellscript|shell|bash|sh|zsh)/.test(n.className),d=[".vp-copy-ignore",".diff.remove"],a=o.cloneNode(!0);a.querySelectorAll(d.join(",")).forEach(c=>c.remove());let l=a.textContent||"";r&&(l=l.replace(/^ *(\$|>) /gm,"").trim()),g(l).then(()=>{t.classList.add("copied"),clearTimeout(s.timeoutIdMap.get(t));const c=setTimeout(()=>{t.classList.remove("copied"),t.blur(),s.timeoutIdMap.delete(t)},2e3);s.timeoutIdMap.set(t,c)})}}add(){window.addEventListener("click",this.copyButtonClick),this.removeHandler=()=>{window.removeEventListener("click",this.copyButtonClick)}}}const p=new s;function h(){m&&p.reset()}async function g(i){try{return navigator.clipboard.writeText(i)}catch{const e=document.createElement("textarea"),t=document.activeElement;e.value=i,e.setAttribute("readonly",""),e.style.contain="strict",e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="12pt";const n=document.getSelection(),o=n?n.rangeCount>0&&n.getRangeAt(0):null;document.body.appendChild(e),e.select(),e.selectionStart=0,e.selectionEnd=i.length,document.execCommand("copy"),document.body.removeChild(e),o&&(n.removeAllRanges(),n.addRange(o)),t&&t.focus()}}export{u as T,h as u};
